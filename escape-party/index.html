<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Escape Party ‚Ä¢ Crea Stanza</title>
  <link rel="stylesheet" href="style.css">
</head>
<body class="index-page"> <!-- üëà AGGIUNTA LA CLASSE -->
  <div class="container">
    <div class="card">
      <h1>Escape Room PixelUp ‚Äî Party Edition</h1>
      <p class="notice">Min <strong>4</strong>, max <strong>8</strong> giocatori.</p>

      <div class="col center">
        <button id="createBtn" class="btn btn-primary">Crea Stanza</button>
      </div>

      <div id="qrBox" class="center" style="display:none; margin-top:20px;">
        <div class="hr" style="margin:18px 0;height:1px;background:#2a3140"></div>
        <p>Condividi questo QR ai giocatori per unirsi con il telefono:</p>
        <img id="roomQR" class="img" style="max-width:280px" alt="QR join">
        <p class="notice">Oppure link: <a id="joinLink" href="#" target="_blank" rel="noopener">Apri Player</a></p>
        <p><a id="hostLink" class="btn btn-primary" target="_blank">Apri Host (TV)</a></p>
        <p class="notice">Quando sarete in <strong>4‚Äì8</strong> giocatori, dalla TV premete ‚ÄúAvvia‚Äù.</p>
      </div>
    </div>
  </div>

  <script type="module">
    import { createRoom } from './app.js';

    document.getElementById('createBtn').onclick = async ()=>{
      const code = await createRoom({});
      const joinURL = `${location.origin}${location.pathname.replace('index.html','')}player.html?code=${code}`;
      const hostURL = `${location.origin}${location.pathname.replace('index.html','')}host.html?code=${code}`;

      document.getElementById('qrBox').style.display='block';
      document.getElementById('joinLink').href = joinURL;
      document.getElementById('hostLink').href = hostURL;
      document.getElementById('roomQR').src =
        `https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${encodeURIComponent(joinURL)}`;
    };
  </script>
</body>
</html>
